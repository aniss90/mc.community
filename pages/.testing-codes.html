<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <title>ثقب أسود 3D</title>
  <style>
    body { margin:0; overflow:hidden; background:black; }
    #btns {
      position:absolute; top:10px; left:10px;
      display:flex; flex-direction:column; gap:8px;
    }
    button {
      padding:8px 12px; border:none; border-radius:6px;
      background:rgba(255,255,255,0.85); cursor:pointer;
    }
  </style>
</head>
<body>
  <div id="btns">
    <button id="toggleWarp">إظهار/إخفاء تشوه الزمكان</button>
    <button id="toggleDisk">إظهار/إخفاء قرص التراكم</button>
  </div>

  <script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';
    import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
    camera.position.set(0,2,6);

    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // ثقب أسود
    const bh = new THREE.Mesh(
      new THREE.SphereGeometry(1,64,64),
      new THREE.MeshBasicMaterial({color:0x000000})
    );
    scene.add(bh);

    // قرص التراكم
    const disk = new THREE.Mesh(
      new THREE.TorusGeometry(2,0.3,32,128),
      new THREE.MeshBasicMaterial({color:0xffaa44, transparent:true, opacity:0.6, side:THREE.DoubleSide})
    );
    disk.rotation.x = Math.PI/2;
    scene.add(disk);

    // نجوم
    const starsGeo = new THREE.BufferGeometry();
    const starCount = 2000;
    const pos = [];
    for(let i=0;i<starCount;i++){
      pos.push((Math.random()-0.5)*2000);
      pos.push((Math.random()-0.5)*2000);
      pos.push((Math.random()-0.5)*2000);
    }
    starsGeo.setAttribute("position", new THREE.Float32BufferAttribute(pos,3));
    const stars = new THREE.Points(starsGeo,new THREE.PointsMaterial({color:0xffffff, size:1}));
    scene.add(stars);

    // شبكة تشوه
    function makeWarp(strength=2){
      const geo = new THREE.PlaneGeometry(12,12,80,80);
      const pos = geo.attributes.position;
      for(let i=0;i<pos.count;i++){
        const x=pos.getX(i), y=pos.getY(i);
        const r=Math.sqrt(x*x+y*y);
        const z=-strength/(r+0.2);
        pos.setZ(i,z);
      }
      const wire = new THREE.WireframeGeometry(geo);
      return new THREE.LineSegments(wire,new THREE.LineBasicMaterial({color:0x00ffff}));
    }
    const warp = makeWarp(2);
    warp.rotation.x = -Math.PI/2;
    warp.visible = false;
    scene.add(warp);

    // أزرار
    document.getElementById("toggleWarp").onclick=()=>warp.visible=!warp.visible;
    document.getElementById("toggleDisk").onclick=()=>disk.visible=!disk.visible;

    // أنيميشن
    function animate(){
      requestAnimationFrame(animate);
      disk.rotation.z += 0.01;
      controls.update();
      renderer.render(scene,camera);
    }
    animate();

    window.addEventListener("resize",()=>{
      camera.aspect=innerWidth/innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth,innerHeight);
    });
  </script>
</body>
</html>