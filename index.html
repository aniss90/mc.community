<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MC CO</title>
  <link rel="stylesheet" href="style/main.css" />
  <link rel="icon" type="image/x-icon" href="web/ytlogo.png" />
  <style>
    body.locked {
      background-color: #121212;
      color: #fff;
      font-family: minecraft-five;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
      flex-direction: column;
      padding: 20px;
    }

    .download-btn {
      margin-top: 20px;
      padding: 10px 25px;
      font-size: 16px;
      background-color: #FFD952;
      border: none;
      border-radius: 5px;
      color: #000;
      font-family: minecraft;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div id="mainContent" style="display: none;">
    <!-- محتوى موقعك هنا -->
    <h1>أهلاً بك في MC CO</h1>
    <p>هذا المحتوى يظهر فقط داخل التطبيق</p>
  </div>

  <script>
    function isAndroid() {
      return /Android/i.test(navigator.userAgent);
    }
// تحقق إن المستخدم داخل متصفح أندرويد
if (isAndroid() && localStorage.getItem("in_app") !== "true") {
  // حاول فتح التطبيق إذا كان مثبتًا
  setTimeout(function() {
    window.location.href = "intent://main#Intent;scheme=mc.co.community.webapp;package=mc.co.community.webapp;end";
  }, 500);
  
  // بعد ثواني، إذا ما فتح التطبيق، نعرض رسالة تحميل
  setTimeout(function() {
    document.body.classList.add("locked");
    document.body.innerHTML = `
      <h2>يرجى تحميل التطبيق لاستخدام هذا الموقع</h2>
      <button class="download-btn" onclick="downloadApp()">تحميل التطبيق</button>
    `;
  }, 2000);
}
    function isInApp() {
      return typeof cordova !== 'undefined'; // متغير متاح فقط داخل التطبيق
    }

    function markAsInApp() {
      localStorage.setItem('in_app', 'true');
    }

    function downloadApp() {
      window.location.href = 'mc_co.apk';
    }

    window.onload = function () {
      if (isInApp()) {
        markAsInApp(); // إذا كان في التطبيق
        document.getElementById("mainContent").style.display = "block";
      } else if (isAndroid() && localStorage.getItem("in_app") !== "true") {
        // إذا كان من المتصفح ولم يثبت التطبيق
        document.body.classList.add("locked");
        document.body.innerHTML = `
          <h2>يرجى تحميل التطبيق لاستخدام هذا الموقع</h2>
          <button class="download-btn" onclick="downloadApp()">تحميل التطبيق</button>
        `;
      } else {
        // تم فتح الموقع من داخل التطبيق مسبقًا
        document.getElementById("mainContent").style.display = "block";
      }
    };
  </script>

  <!-- سكريبتات Cordova فقط داخل التطبيق -->
  <script type="module">
    document.addEventListener('DOMContentLoaded', function () {
      if (typeof cordova !== 'undefined' && cordova.platformId === 'android') {
        const androidVersion = window.device ? parseInt(window.device.version.split('.')[0]) : 0;
        if (androidVersion >= 13) {
          if (window.cordova.plugins && window.cordova.plugins.notification) {
            cordova.plugins.notification.local.requestPermission(function (granted) {
              console.log('الإذن:', granted ? 'مُمنوح' : 'مرفوض');
            });
          } else {
            console.error('بلجن الإشعارات غير مثبت!');
          }
        }
      }
    });
  </script>
</body>
</html>